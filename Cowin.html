<!DOCTYPE html>
<html>
<style type="text/css">
	#View{
	padding: 15px 0px;
	}
html {    
    background: url('BackImage.jpg') no-repeat center fixed;     
    background-size: cover;
}
	body {
	font-size: 1rem !important;
	background-color: transparent !important;
	}
	.tableFixHead  {
	overflow: auto;
	max-height: 500px;

	}
	.tableFixHead thead  { 
		position: -webkit-sticky;
	position: sticky; 
	top: 0;
	z-index: 1; 
	}
	.covin-img{
	background-image: url(BackImage.jpg);
	background-position: center;
	background-attachment: fixed;
	background-repeat: no-repeat;
	background-size: 100% 100%;
	position: relative;
	color: white;
	}
.borderless td, .borderless th {
    border: none !important;
}
	.gold-color{
background: linear-gradient(120deg, #1798c1, #ff1100);

		/*background: radial-gradient(ellipse at center, #e0b520 0%,#1f1c1a 100%) !important;*/
	}
	.gold-plated-color{
		background: linear-gradient(to bottom, #82f3ff 26%, #24e6d4 27%,#0f6b62 78%) !important;
		color: white ;
		/*background:linear-gradient(to bottom, #cfc09f 26%, #cfc09f 27%,#ffecb3 78%) !important;*/
	}

	.loader {
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite; /* Safari */
  animation: spin 2s linear infinite;
}

/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>
<head>
	<meta charset="utf-8">
	<title>COVID-19 vaccination in India</title>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
</head>
<body>

<div class="container-fluid">
	

<div id="View"  ></div>
</div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

</body>
<script type="text/javascript">
	
	var selectedDate;
	var model={};
	model.DistrictInfo=[];
	var selectedDistrict;
	function AjaxCall(APIUrl)
	{
		/*$.getJSON("https://cdn-api.co-vin.in/api/v2/admin/location/districts/31", function(result){console.log(result)});*/
		var result={};
		$.ajax
		({
			type: "GET",
			url: APIUrl,
			contentType: "application/json; charset=utf-8",
			async: false,
			success:function(data){ 
			result=data;
			},
		});
		return result;
	}





function AddDiv(data){
$("#JasonTxtBox").val(data.districts.length);
AddDrpvalues(JasonTxtDiv,data.districts);
}

function log(e){
	console.log(e)

}

function onDropdownChange(e)
{
    var id=e.target.id;
    var index=e.target.value;
    var name=e.target.getAttribute('name');

    if(name=='Districts')
    {
    	model[name].forEach(function (el,i){
    	el.selected=(index==i);	
    	})
    	selectedDistrict=model[name][index].district_id;
	getDistrictInformation();
    }
    
// var Districtdata=AjaxCall("https://cdn-api.co-vin.in/api/v2/admin/location/districts/"+selectedValue);
// AjaxCall("https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id="+selectedValue+"&date="+selectedDate+"');
// AddDrpvalues(data.sessions,)
}

function getDistrictInformation(){
var DistrictInfo=AjaxCall('https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id='+selectedDistrict+'&date='+selectedDate);
	model.DistrictInfo=DistrictInfo.sessions;
	render();
}

function onGenerateDropdown(data,name,id,text)
{
	var html='';
	html+='<div class="form-floating" >';
	html+='<select id="'+id+'" name="'+name+'" class="mc-dropdown form-select">';
	html+='<option value="0">Choose '+name+'</option>';
	if(data.length>0)
	{
		data.forEach(function (e,ind){
			var selected=e.selected?'selected':'';
		html+='<option value="'+ind+'" '+selected+'>'+e[text]+'</option>';
		});
	}
	html+='</select>';
	html+='<label for="floatingSelect">Select District</label>';
	html+='</div>';
	return html;
}

function onGenerateGrid(data)
{
	var html='';
	html+='<table class="table table-borderless table-dark table-hover" >';
	if(data.length>0)
	{
	html+='<thead  class="gold-plated-color">';
	html+='<th scope="col">Name</th>';
	html+='<th scope="col">Vaccine</th>';
	html+='<th scope="col">Age</th>';
	html+='<th scope="col">Dosage 1</th>';
	html+='<th scope="col">Dosage 2</th>';
	html+='<th scope="col">Fee</th>';
	html+='<th scope="col">Amount</th>';
	html+='</thead>';
	html+='<tbody class="borderless" style="opacity:0.9 !important;">';
	data.forEach(function (e){
		html+='<tr>';
		html+='<td scope="row">'+e.name+'</td>';
		html+='<td scope="row">'+e.vaccine+'</td>';
		html+='<td scope="row">'+e.min_age_limit+'+</td>';
		html+='<td scope="row">'+e.available_capacity_dose1+'</td>';
		html+='<td scope="row">'+e.available_capacity_dose2+'</td>';
		html+='<td scope="row">'+e.fee_type+'</td>';
		html+='<td scope="row">'+e.fee+'</td>';
		html+='</tr>';
	});
	html+='</tbody>';

	}
	html+='</table>';
	return html;
	
}
function render(){
	var html='';
		html+='<div class="row">';
			html+='<div class="col-lg-offset-10 col-md-offset-10 col-lg-2 col-md-2 col-sm-12 .col-xs-12">';
				html+=onGenerateDropdown(model.Districts,'Districts','DistrictDrpdown','district_name');
			html+='</div>';	

		html+='</div><br>';
			html+='<div class="row">';
				html+='<div class="col-sm-12">';
					html+='<div class=" tableFixHead">';
					html+=onGenerateGrid(model.DistrictInfo);
					html+='</div>';
				html+='</div>';
			html+='</div>';
	$("#View").empty().append(html);

	$('.mc-dropdown').on('change',onDropdownChange);


}
function getDistrictData(stateId){
	var districtsData=AjaxCall("https://cdn-api.co-vin.in/api/v2/admin/location/districts/"+stateId);
	model.Districts=districtsData.districts;
	render();
}

function convertDate(inputDate) {function pad(s)
 { 
	return (s < 10) ? '0' + s : s; 
}
	var d = new Date(inputDate);
	return [pad(d.getDate()), pad(d.getMonth()+1), d.getFullYear()].join('-');
}

function load(){
	getDistrictData(31);
	selectedDate=convertDate(new Date());

$(window).load(function() {
	$(".loader").animate({
				top: -200
			}, 1500);
});
}

$(document).ready(
	load

	);
</script>
</html>